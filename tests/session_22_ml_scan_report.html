<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Scan Report - security_assistant/</title>
    <style>
        /* Security Assistant Report Styles */

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, &#39;Segoe UI&#39;, Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    line-height: 1.6;
    color: #333;
    background: #f5f5f5;
    padding: 20px;
}

.container {
    max-width: 1400px;
    margin: 0 auto;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    overflow: hidden;
}

header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 40px;
    text-align: center;
}

header h1 {
    font-size: 2.5em;
    margin-bottom: 10px;
}

header p {
    font-size: 1.1em;
    opacity: 0.9;
}

.content {
    padding: 40px;
}

.summary {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 40px;
}

.stat-card {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    border-left: 4px solid #667eea;
}

.stat-card h3 {
    font-size: 0.9em;
    color: #666;
    text-transform: uppercase;
    margin-bottom: 10px;
}

.stat-card .value {
    font-size: 2em;
    font-weight: bold;
    color: #333;
}

.stat-card.critical {
    border-left-color: #dc3545;
}

.stat-card.high {
    border-left-color: #fd7e14;
}

.stat-card.medium {
    border-left-color: #ffc107;
}

.stat-card.low {
    border-left-color: #28a745;
}

.section {
    margin-bottom: 40px;
}

.section h2 {
    font-size: 1.8em;
    margin-bottom: 20px;
    color: #333;
    border-bottom: 2px solid #667eea;
    padding-bottom: 10px;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

th, td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

th {
    background: #f8f9fa;
    font-weight: 600;
    color: #333;
}

tr:hover {
    background: #f8f9fa;
}

.severity-badge {
    display: inline-block;
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 0.85em;
    font-weight: 600;
    text-transform: uppercase;
}

.severity-critical {
    background: #dc3545;
    color: white;
}

.severity-high {
    background: #fd7e14;
    color: white;
}

.severity-medium {
    background: #ffc107;
    color: #333;
}

.severity-low {
    background: #28a745;
    color: white;
}

.severity-info {
    background: #6c757d;
    color: white;
}

.scanner-badge {
    display: inline-block;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.85em;
    background: #e9ecef;
    color: #495057;
}

.code-snippet {
    background: #f8f9fa;
    border-left: 4px solid #667eea;
    padding: 15px;
    margin: 10px 0;
    overflow-x: auto;
    font-family: &#39;Courier New&#39;, monospace;
    font-size: 0.9em;
}

.finding-details {
    display: none;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 4px;
    margin-top: 10px;
}

.finding-row {
    cursor: pointer;
}

.finding-row:hover {
    background: #e9ecef;
}

footer {
    background: #f8f9fa;
    padding: 20px 40px;
    text-align: center;
    color: #666;
    font-size: 0.9em;
}

.chart-container {
    margin: 30px 0;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 8px;
}

@media print {
    body {
        background: white;
    }
    
    .container {
        box-shadow: none;
    }
    
    .finding-details {
        display: block !important;
    }
}

@media (max-width: 768px) {
    .summary {
        grid-template-columns: 1fr;
    }
    
    header h1 {
        font-size: 1.8em;
    }
    
    .content {
        padding: 20px;
    }
}

    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîí Security Scan Report - security_assistant/</h1>
            <p>Comprehensive Security Analysis Report</p>
        </header>
        
        <div class="content">
            <!-- Summary Section -->
            <div class="section">
                <h2>üìä Executive Summary</h2>
                <div class="summary">
                    <div class="stat-card">
                        <h3>Total Findings</h3>
                        <div class="value">2</div>
                    </div>
                    <div class="stat-card">
                        <h3>Unique Issues</h3>
                        <div class="value">2</div>
                    </div>
                    <div class="stat-card critical">
                        <h3>Critical</h3>
                        <div class="value">0</div>
                    </div>
                    <div class="stat-card high">
                        <h3>High</h3>
                        <div class="value">0</div>
                    </div>
                    <div class="stat-card medium">
                        <h3>Medium</h3>
                        <div class="value">2</div>
                    </div>
                    <div class="stat-card low">
                        <h3>Low</h3>
                        <div class="value">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Scan Time</h3>
                        <div class="value">1.6s</div>
                    </div>
                    <div class="stat-card">
                        <h3>Duplicates Removed</h3>
                        <div class="value">0</div>
                    </div>
                </div>
            </div>
            
            <!-- Severity Breakdown -->
            <div class="section">
                <h2>üéØ Severity Breakdown</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Severity</th>
                            <th>Count</th>
                            <th>Percentage</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="severity-badge severity-critical">CRITICAL</span></td>
                            <td>0</td>
                            <td>0.0%</td>
                        </tr>
                        <tr>
                            <td><span class="severity-badge severity-high">HIGH</span></td>
                            <td>0</td>
                            <td>0.0%</td>
                        </tr>
                        <tr>
                            <td><span class="severity-badge severity-medium">MEDIUM</span></td>
                            <td>2</td>
                            <td>100.0%</td>
                        </tr>
                        <tr>
                            <td><span class="severity-badge severity-low">LOW</span></td>
                            <td>0</td>
                            <td>0.0%</td>
                        </tr>
                        <tr>
                            <td><span class="severity-badge severity-info">INFO</span></td>
                            <td>0</td>
                            <td>0.0%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Scanner Breakdown -->
            <div class="section">
                <h2>üîç Scanner Breakdown</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Scanner</th>
                            <th>Findings</th>
                            <th>Percentage</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="scanner-badge">bandit</span></td>
                            <td>2</td>
                            <td>100.0%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Charts Section -->
            <div class="section">
                <h2>üìà Visual Analytics</h2>
                <div class="chart-container">
                    <canvas id="severityChart" width="400" height="200"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="scannerChart" width="400" height="200"></canvas>
                </div>
            </div>
            
            <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
            <script>
                
// Severity Chart
const severityCtx = document.getElementById(&#39;severityChart&#39;).getContext(&#39;2d&#39;);
new Chart(severityCtx, {
    type: &#39;bar&#39;,
    data: {
        labels: [&#34;CRITICAL&#34;, &#34;HIGH&#34;, &#34;MEDIUM&#34;, &#34;LOW&#34;, &#34;INFO&#34;],
        datasets: [{
            label: &#39;Findings by Severity&#39;,
            data: [0, 0, 2, 0, 0],
            backgroundColor: [
                &#39;#dc3545&#39;,
                &#39;#fd7e14&#39;,
                &#39;#ffc107&#39;,
                &#39;#28a745&#39;,
                &#39;#6c757d&#39;
            ]
        }]
    },
    options: {
        responsive: true,
        plugins: {
            title: {
                display: true,
                text: &#39;Findings by Severity&#39;
            }
        }
    }
});

// Scanner Chart
const scannerCtx = document.getElementById(&#39;scannerChart&#39;).getContext(&#39;2d&#39;);
new Chart(scannerCtx, {
    type: &#39;pie&#39;,
    data: {
        labels: [&#34;bandit&#34;],
        datasets: [{
            label: &#39;Findings by Scanner&#39;,
            data: [2],
            backgroundColor: [
                &#39;#667eea&#39;,
                &#39;#764ba2&#39;,
                &#39;#f093fb&#39;
            ]
        }]
    },
    options: {
        responsive: true,
        plugins: {
            title: {
                display: true,
                text: &#39;Findings by Scanner&#39;
            }
        }
    }
});

            </script>
            
            <!-- Findings Table -->
            <div class="section">
                <h2>üîé Detailed Findings</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Severity</th>
                            <th>Title</th>
                            <th>File</th>
                            <th>Line</th>
                            <th>Scanner</th>
                            <th>Priority</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="finding-row" onclick="toggleDetails(0)">
                            <td><span class="severity-badge severity-medium">MEDIUM</span></td>
                            <td>blacklist</td>
                            <td>scoring.py</td>
                            <td>128</td>
                            <td><span class="scanner-badge">bandit</span></td>
                            <td>48.5</td>
                        </tr>
                        <tr>
                            <td colspan="6">
                                <div id="details-0" class="finding-details">
                                    <p><strong>Description:</strong> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.</p>
                                    <p><strong>File:</strong> security_assistant/ml\scoring.py</p>
                                    <p><strong>Lines:</strong> 128-128</p>
                                    
                                    <div class="code-snippet">
                                        <pre>127             with open(path, &#34;rb&#34;) as f:
128                 model_data = pickle.load(f)
129</pre>
                                    </div>
                                    
                                    <p><strong>CWE:</strong> 502</p>
                                    
                                </div>
                            </td>
                        </tr>
                        <tr class="finding-row" onclick="toggleDetails(1)">
                            <td><span class="severity-badge severity-medium">MEDIUM</span></td>
                            <td>blacklist</td>
                            <td>performance.py</td>
                            <td>396</td>
                            <td><span class="scanner-badge">bandit</span></td>
                            <td>48.5</td>
                        </tr>
                        <tr>
                            <td colspan="6">
                                <div id="details-1" class="finding-details">
                                    <p><strong>Description:</strong> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.</p>
                                    <p><strong>File:</strong> security_assistant/performance.py</p>
                                    <p><strong>Lines:</strong> 396-396</p>
                                    
                                    <div class="code-snippet">
                                        <pre>395             with open(self.persist_path, &#39;rb&#39;) as f:
396                 data = pickle.load(f)
397                 self._cache = data.get(&#39;cache&#39;, {})</pre>
                                    </div>
                                    
                                    <p><strong>CWE:</strong> 502</p>
                                    
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <script>
                function toggleDetails(idx) {
                    const details = document.getElementById('details-' + idx);
                    if (details.style.display === 'block') {
                        details.style.display = 'none';
                    } else {
                        details.style.display = 'block';
                    }
                }
            </script>
        </div>
        
        <footer>
            <p>Generated by Security Assistant on 2025-12-02 15:52:21</p>
            <p>Target: security_assistant/ | Execution Time: 1.58s</p>
        </footer>
    </div>
</body>
</html>